schema: '2.0'
stages:
  preprocess:
    cmd: python src/preprocessing.py
    deps:
    - path: data/raw/train/batch_1.csv
      hash: md5
      md5: 0ec5ad530d945e0054b1ac14d4e5faba
      size: 3307219
    - path: data/raw/train/batch_2.csv
      hash: md5
      md5: 6284cfdd71b2839c96ee712cc91ac229
      size: 3320478
    - path: data/raw/train/batch_3.csv
      hash: md5
      md5: 829d4b66309ccbde4cbda602351ae837
      size: 3378343
    - path: data/raw/train/batch_4.csv
      hash: md5
      md5: 30108e2b71f55cf1e7e0caefa3246b69
      size: 1603519
    - path: src/preprocessing.py
      hash: md5
      md5: c52183b13a1c8246066a425aca73f12f
      size: 5651
    params:
      params.yaml:
        preprocess:
          train_dir: data/raw/train
          test_dir: data/raw/test
          output_dir: data/processed
          k_best_features: 20
          variance_threshold: 0.01
          random_state: 42
    outs:
    - path: data/processed/
      hash: md5
      md5: 7f1a48a46f1eb23071dcabbe08ea407d.dir
      size: 13727080
      nfiles: 12
  train:
    cmd: python src/modeling.py
    deps:
    - path: data/processed/batch_1_X_processed.csv
      hash: md5
      md5: 9c08c73677587bbddd4e480bd1c424a0
      size: 3916707
    - path: data/processed/batch_1_y_processed.csv
      hash: md5
      md5: 2103c4fcb98057275e87313a18198b84
      size: 90014
    - path: data/processed/batch_2_X_processed.csv
      hash: md5
      md5: 5478b2d5b23e2555ded6a5867687cf2c
      size: 3811269
    - path: data/processed/batch_2_y_processed.csv
      hash: md5
      md5: c4a10c2bcb26b56d7055e7757947c89f
      size: 90014
    - path: data/processed/batch_3_X_processed.csv
      hash: md5
      md5: 8a8429d135a748061f04dea9b79f91de
      size: 4098315
    - path: data/processed/batch_3_y_processed.csv
      hash: md5
      md5: 25182b46b46af1b3aa80c7399128805a
      size: 90014
    - path: data/processed/batch_4_X_processed.csv
      hash: md5
      md5: 71ae4efff277bdf99eb593ad82d1f21a
      size: 1567805
    - path: data/processed/batch_4_y_processed.csv
      hash: md5
      md5: 27e1fb7d13e36c8a182e25847d1e8ba1
      size: 41726
    - path: src/modeling.py
      hash: md5
      md5: e0fcd95a2b02984322a1546fbd032a12
      size: 10096
    params:
      params.yaml:
        train:
          data_path: data/processed
          output_dir: models
          validation_size: 0.2
          random_state: 42
          rf_n_estimators: 100
          rf_max_depth: 15
          rf_min_samples_split: 10
          rf_min_samples_leaf: 4
          xgb_n_estimators: 100
          xgb_max_depth: 8
          xgb_learning_rate: 0.1
          xgb_subsample: 0.8
          xgb_colsample_bytree: 0.8
          lgb_n_estimators: 100
          lgb_max_depth: 7
          lgb_learning_rate: 0.1
          lgb_num_leaves: 31
          lgb_subsample: 0.8
          lgb_colsample_bytree: 0.8
          mlp_hidden_layers:
          - 64
          - 32
          mlp_activation: relu
          mlp_alpha: 0.001
          mlp_batch_size: 256
          mlp_max_iter: 200
          stacking_cv: 5
    outs:
    - path: models/
      hash: md5
      md5: b0eb80f215e54a30abf3418a077f8e2f.dir
      size: 77507734
      nfiles: 41
  batch_evaluation:
    cmd: python src/batch_evaluation.py
    deps:
    - path: data/processed/preprocessing_objects.pkl
      hash: md5
      md5: ee6f392b65ec5e3078c0e3097592bc37
      size: 5966
    - path: data/raw/test/batch_test.csv
      hash: md5
      md5: 5a28d689430b20d42e42f0d31ac7cb96
      size: 2892941
    - path: data/raw/train/batch_1.csv
      hash: md5
      md5: 0ec5ad530d945e0054b1ac14d4e5faba
      size: 3307219
    - path: data/raw/train/batch_2.csv
      hash: md5
      md5: 6284cfdd71b2839c96ee712cc91ac229
      size: 3320478
    - path: data/raw/train/batch_3.csv
      hash: md5
      md5: 829d4b66309ccbde4cbda602351ae837
      size: 3378343
    - path: data/raw/train/batch_4.csv
      hash: md5
      md5: 30108e2b71f55cf1e7e0caefa3246b69
      size: 1603519
    - path: src/batch_evaluation.py
      hash: md5
      md5: 3484287714b7198a5a127ce12435c6b9
      size: 19233
    outs:
    - path: reports/batch_analysis/
      hash: md5
      md5: 6b5959539fcb926a6aa91da59febc250.dir
      size: 350502
      nfiles: 5
  evaluate:
    cmd: python src/batch_evaluation.py
    deps:
    - path: models/batch_1/metadata.json
      hash: md5
      md5: 0eb63fe05187b8cac76ba477c336e75d
      size: 339
    - path: models/batch_2/metadata.json
      hash: md5
      md5: b2a2f2a57dc666e48df6bd8830e9dae9
      size: 329
    - path: models/batch_3/metadata.json
      hash: md5
      md5: de735aa9cb5f268abc474a49ec670373
      size: 329
    - path: models/batch_4/metadata.json
      hash: md5
      md5: e17014ef3479f11f390d16a589ce031b
      size: 330
    - path: src/batch_evaluation.py
      hash: md5
      md5: 8f5ba54109cb9e8dee2c42e7e766a13f
      size: 12101
    outs:
    - path: reports/batch_analysis/
      hash: md5
      md5: 21915be3dbf0584a6757856ec4f80a85.dir
      size: 873437
      nfiles: 7
  train_mlflow:
    cmd: python src/modeling_mlflow.py
    deps:
    - path: data/processed/batch_1_X_processed.csv
      hash: md5
      md5: 9c08c73677587bbddd4e480bd1c424a0
      size: 3916707
    - path: data/processed/batch_1_y_processed.csv
      hash: md5
      md5: 2103c4fcb98057275e87313a18198b84
      size: 90014
    - path: data/processed/batch_2_X_processed.csv
      hash: md5
      md5: 5478b2d5b23e2555ded6a5867687cf2c
      size: 3811269
    - path: data/processed/batch_2_y_processed.csv
      hash: md5
      md5: c4a10c2bcb26b56d7055e7757947c89f
      size: 90014
    - path: data/processed/batch_3_X_processed.csv
      hash: md5
      md5: 8a8429d135a748061f04dea9b79f91de
      size: 4098315
    - path: data/processed/batch_3_y_processed.csv
      hash: md5
      md5: 25182b46b46af1b3aa80c7399128805a
      size: 90014
    - path: data/processed/batch_4_X_processed.csv
      hash: md5
      md5: 71ae4efff277bdf99eb593ad82d1f21a
      size: 1567805
    - path: data/processed/batch_4_y_processed.csv
      hash: md5
      md5: 27e1fb7d13e36c8a182e25847d1e8ba1
      size: 41726
    - path: src/modeling_mlflow.py
      hash: md5
      md5: 496f361be00477bb81948523ac17a4e1
      size: 15022
    params:
      params.yaml:
        train:
          data_path: data/processed
          output_dir: models
          validation_size: 0.2
          random_state: 42
          register_model: true
          registry_name: AirlineSatisfaction_Production
          rf_n_estimators: 100
          rf_max_depth: 15
          rf_min_samples_split: 10
          rf_min_samples_leaf: 4
          xgb_n_estimators: 100
          xgb_max_depth: 8
          xgb_learning_rate: 0.1
          xgb_subsample: 0.8
          xgb_colsample_bytree: 0.8
          lgb_n_estimators: 100
          lgb_max_depth: 7
          lgb_learning_rate: 0.1
          lgb_num_leaves: 31
          lgb_subsample: 0.8
          lgb_colsample_bytree: 0.8
          mlp_hidden_layers:
          - 64
          - 32
          mlp_activation: relu
          mlp_alpha: 0.001
          mlp_batch_size: 256
          mlp_max_iter: 200
          stacking_cv: 5
    outs:
    - path: mlruns/
      hash: md5
      md5: fa6aa18a6a4f2365946316968321b5e6.dir
      size: 72831865
      nfiles: 2478
    - path: models/
      hash: md5
      md5: a15a9d5f216e42cc18cf273f2eeadf66.dir
      size: 77508638
      nfiles: 41
